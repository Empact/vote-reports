<%- data = score_evidence_points(score) -%>
<% javascript_tag do %>
  new Highcharts.Chart({
    chart: {
      renderTo: '<%= dom_id(score, :evidence) %>',
      defaultSeriesType: 'line',
      margin: [80, 10, 40, 60]
    },
    title: {
      text: '<%= escape_javascript(score_title(score)) %>',
    },
    subtitle: {
      text: 'based on <%= escape_javascript(score_evidence_components(score).join(', ')) %>',
    },
    xAxis: {
      categories: <%= raw data.map {|p| p[:x] }.to_json %>
    },
    yAxis: {
      min: -2,
      max: 102,
      endOnTick: false,
      startOnTick: false,
      title: {
         text: 'Rating'
      }
    },
    tooltip: {
      formatter: function() {
        return this.point.name;
      },
      style: {
        whiteSpace: 'normal'
      }
    },
    legend: {
      enabled: false
    },
    series: [{
      name: '<%= escape_javascript(score.report.name) %>',
      type: 'line',
      data: <%= raw data.map {|p| p.slice(:y, :name) }.to_json %>
    }]
  });
<% end %>

<% div_for(score, :evidence, :style => "width: 100%; height: 400px") do %>
<% end %>
