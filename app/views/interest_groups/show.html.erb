<% title "Interest Group - #{h @interest_group.name}" %>

 <%= render 'interest_groups/header', :interest_group => @interest_group %>
<div class="tabbed-nav">
  
  <ul>
    <li><a href="#report_scores_section">Scores</a></li>
    <li><a href="#report_subjects">Subjects</a></li>
    <li><a href="#interest_group_ratings">Agenda</a></li>
    <%- permitted_to? :edit, :interest_groups_images do -%>
    <li><a href="#admin">Admin</a></li>
    <%- end -%>
  </ul>
  
  <div id="report_scores_section" class="section report_scores">
    <h3>Scores</h3>
    <p>We score representatives based on the actual ratings this interest group has released over time.</p>
    <%- if @report -%>
      <%- if @report.scores.present? -%>
        <%= render 'politicians/search', :in_office => @in_office, :url => interest_group_path(@interest_group), :replace => 'report_scores' %>
      <%- end -%>
      <%= render 'reports/scores/table', :report => @report, :scores => @scores %>
    <%- else -%>
      <p>No ratings on record for this group</p>
    <%- end -%>
  </div>

  <%- if parent = @interest_group.parent -%>
  <div class="section">
    <h3>Parent Group</h3>
    <%= render parent %>
  </div>
  <%- end -%>

  <%- if @interest_group.parent && (siblings = @interest_group.siblings).present? -%>
  <div class="section">
    <h3><%= pluralize siblings.count, 'Sibling Group' %></h3>
    <ul>
      <%- siblings.each do |sibling| -%>
      <li><%= render sibling %></li>
      <%- end -%>
    </ul>
  </div>
  <%- end -%>

  <%- if (children = @interest_group.children).present? -%>
  <div class="section">
    <h3><%= pluralize children.count, 'Child Group' %></h3>
    <ul>
      <%- children.each do |child| -%>
      <li><%= render child %></li>
      <%- end -%>
    </ul>
  </div>
  <%- end -%>

  <div id="report_subjects" class="section report_subjects">
    <h3>Subjects</h3>
    <p>Subjects for this report are selected by <a href="http://votesmart.org/">Project Vote Smart</a>.  Follow the links below to find reports on related subjects.</p>
    <%= render 'subjects/cloud', :subjects => @report.subjects %>
  </div>

  <div id="interest_group_ratings" class="section">
    <h3>Agenda</h3>
    <p>This report's scores are based on ratings periodically issued by the <%= @interest_group.name %>.  All included ratings are shown below.</p>
    <ul>
    <%- @interest_group.reports.each do |report| -%>
      <li><%= render 'interest_group_reports/interest_group_report', :report => report %></li>
    <%- end -%>
    </ul>
  </div>

  <%- permitted_to? :edit, :interest_groups_images do -%>
  <div id="admin">
    <ul class="actions_menu">
      <li><%= link_to 'Edit Interest Group Thumbnail', edit_interest_group_image_path(@interest_group) %></li>
    </ul>
  </div>
  <%- end -%>
</div>
