<%-
  score_count = (scores.count + 1)
  replace ||= 'report_scores'
-%>

<div class="report_scores" id="report_scores">
  <%- if report.delayed_jobs.passing.present? -%>
    <p class="scores_generating notice">
      Updates have been made to this report, and its scores are being updated.<br />
      Check back in a few minutes to see the updated scores.
    </p>
  <%- end -%>
  <%- if report.delayed_jobs.failing.present? -%>
    <p class="scores_generating error">
      There was a problem updating the scores to this report.<br />
      We at VoteReports will be looking into it shortly, please be patient.
    </p>
  <%- end -%>
<%- if score_count >= 10 -%>
  <% form_tag request.path do %>
    <ul class="score_view_options clearfix">
      <li class="span-6"><%= radio_button_tag :votes, :with, @votes == :with, :class => 'act-replace', :rel => replace %>
      <%= label_tag :votes_with, "Votes With (#{scores.with.count})", :class => 'span-6 last' %></li>
      <li class="span-6"><%= radio_button_tag :votes, :against, @votes == :against, :class => 'act-replace', :rel => replace %>
      <%= label_tag :votes_against, "Votes Against (#{scores.against.count})", :class => 'span-6 last' %></li>
      <li class="span-6 last"><%= radio_button_tag :votes, :neutral, @votes == :neutral, :class => 'act-replace', :rel => replace %>
      <%= label_tag :votes_neutral, "Neutral (#{scores.neutral.count})", :class => 'span-6 last' %></li>
    </ul>
  <% end %>
  <%- scores = scores.with_evidence.paginate(:page => params[:page]) -%>
  <ul class="clearfix">
    <%- scores.each do |score| -%>
      <li class="<%= cycle('left', 'right') %>"><%= render 'politicians/score', :score => score %></li>
    <%- end -%>
  </ul>
  <%= will_paginate scores,
        :class => 'act-replace',
        :rel => replace %>
<%- elsif score_count > 1 -%>
  <%- scores = scores.with_evidence.paginate(:page => params[:page], :total_entries => score_count) -%>
  <table>
    <tbody>
      <tr>
        <td><%= will_paginate scores, :class => 'act-replace', :rel => replace %></td>
      </tr>
      <%- scores.each do |score| -%>
        <tr>
          <td><%= render 'politicians/score', :score => score %></td>
        </tr>
      <%- end -%>
      <tr>
        <td><%= will_paginate scores, :class => 'act-replace', :rel => replace %></td>
      </tr>
    </tbody>
  </table>
<%- elsif report.delayed_jobs.present? -%>
  <p>Scores are being generated. Please try again in a moment.</p>
<%- elsif report.scores.present? && params[:representing].present? -%>
  <p>No scores found for: "<%= params[:representing] %>"</p>
<%- elsif report.owner.is_a?(User) && !report.has_criteria? -%>
  <p>No scores yet, as this report has no criteria to judge representatives by.</p>
<%- elsif report.has_criteria? && report.bill_criteria.active.count == 0 && report.amendment_criteria.active.count == 0 -%>
    <p>No scores yet, as the associated legislation has not been voted on.</p>
<%- elsif report.owner.is_a?(InterestGroup) && report.owner.ratings.blank? -%>
  <p>No ratings on record for this group</p>
<%- elsif report.owner.is_a?(Cause) && report.owner.reports.blank? -%>
  <p>No reports on record for this cause</p>
<%- else -%>
  <p>No scores found</p>
<%- end -%>
</div>